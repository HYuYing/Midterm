#include <Wire.h>
#include <SPI.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define OLED_MOSI 11
#define OLED_CLK  12
#define OLED_DC 9
#define OLED_CS 8
#define OLED_RESET  10
Adafruit_SSD1306 display(OLED_MOSI, OLED_CLK, OLED_DC, OLED_RESET, OLED_CS);

int micPin=3;                                    //設定感測器D0腳位為第3孔
int val;                                                     //設定變量val

//以下為定義按鈕
int buttonPin = 2;
int buttonState = 0;


static const unsigned char PROGMEM logo[]
{
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00001111, B10000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11111111, B11111100, B00000000, B00000000, B00000000, 
  B00000000, B00000001, B11110011, B11111111, B11111110, B01111100, B00000000, B00000000, 
  B00000000, B00000001, B11111011, B11111100, B11111111, B01111100, B00000000, B00000000, 
  B00000000, B00000001, B11111011, B11110000, B01111110, B01111100, B00000000, B00000000, 
  B00000000, B00000001, B11011000, B11111101, B11111100, B11011100, B00000000, B00000000, 
  B00000000, B00000000, B11101110, B01111111, B11110011, B10111100, B00000000, B00000000, 
  B00000000, B00000000, B11110011, B00011111, B11100110, B01111100, B00000000, B00000000, 
  B00000000, B00000000, B11111001, B11001111, B10001100, B11111000, B00000000, B00000000, 
  B00000000, B00000000, B11101110, B11100111, B00011011, B10111000, B00000000, B00000000, 
  B00000000, B00000000, B11110011, B01101000, B00110110, B01111000, B00000000, B00000000, 
  B00000000, B00000000, B01111101, B11101101, B10111100, B11110000, B00000000, B00000000, 
  B00000000, B00000000, B00111110, B01111111, B10110011, B11100000, B00000000, B00000000, 
  B00000000, B00000000, B00001111, B10110111, B10110111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B01100111, B11110111, B01111111, B00110000, B00000000, B00000000, 
  B00000000, B00000000, B01110001, B11100111, B00111100, B01110000, B00000000, B00000000, 
  B00000000, B00000000, B01111000, B00000111, B00000000, B01110000, B00000000, B00000000, 
  B00000000, B00000000, B00111000, B00000111, B00000000, B01110000, B00000000, B00000000, 
  B00000000, B00000000, B00111100, B00110111, B01100001, B11110000, B00000000, B00000000, 
  B00000000, B00000000, B00111110, B01110111, B01110011, B11110000, B00000000, B00000000, 
  B00000000, B00000000, B00111110, B11110111, B01111011, B11110000, B00000000, B00000000, 
  B00000000, B00000000, B00111110, B11110111, B01111011, B11100000, B00000000, B00000000, 
  B00000000, B00000000, B00111110, B11110110, B01111011, B11100000, B00000000, B00000000, 
  B00000000, B00000000, B00111110, B11110000, B01111011, B11100000, B00000000, B00000000, 
  B00000000, B00000000, B00111110, B11111111, B11111011, B11100000, B00000000, B00000000, 
  B00000000, B00000000, B00011110, B11111111, B11111011, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000110, B11100000, B00111011, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000010, B11101111, B00111010, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B11001111, B10111000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00011111, B10000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  
};
static const unsigned char PROGMEM start[]
{
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00011111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00011000, B01100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00011000, B01100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00011000, B01100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00011000, B01100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00011111, B11010111, B00001111, B00000111, B11000011, B11100000, B00000000, B00000000, 
  B00011000, B00011001, B10011001, B10000110, B01000011, B00100000, B00000000, B00000000, 
  B00011000, B00011000, B00111001, B10000110, B00000011, B00000000, B00000000, B00000000, 
  B00011000, B00011000, B00111111, B10000111, B11100011, B11110000, B00000000, B00000000, 
  B00011000, B00011000, B00110000, B00000000, B01100000, B00110000, B00000000, B00000000, 
  B00011000, B00011000, B00110001, B10001100, B01100110, B00110000, B00000000, B00000000, 
  B00011000, B00011000, B00011111, B10001111, B11100111, B11110000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11110000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000110, B00011000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000110, B00011000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000110, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000110, B00000000, B01100000, B00000000, B00000000, B00110000, 
  B00000000, B00000000, B00000110, B00000000, B01100000, B00000000, B00000000, B00110000, 
  B00000000, B00000000, B00000111, B11111001, B11111000, B11111000, B01011100, B11111100, 
  B00000000, B00000000, B00000000, B00001100, B01100001, B10001100, B01100110, B00110000, 
  B00000000, B00000000, B00000000, B00001100, B01100001, B10001100, B01100000, B00110000, 
  B00000000, B00000000, B00001100, B00001100, B01100001, B10001100, B01100000, B00110000, 
  B00000000, B00000000, B00001100, B00001100, B01100001, B10001100, B01100000, B00110000, 
  B00000000, B00000000, B00001100, B00001100, B01100001, B10001100, B01100000, B00110000, 
  B00000000, B00000000, B00000111, B11111100, B01111000, B11110111, B01100000, B00111100, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000,
};
static const unsigned char PROGMEM P1[]
{
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00011111, B11111111, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00011111, B11111111, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000011, B11100000, B00001111, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B11100000, B00011111, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B11100000, B00111111, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B11100000, B01111111, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B11100000, B01111011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B11100000, B01110011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B11100000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000011, B11100000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011111, B11111111, B11000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011111, B11111111, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B01111111, B11111100, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B01111111, B11111100, B00000000, B00000000, 
  B00000000, B00011110, B00000000, B00000000, B01111111, B11111100, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000,
};


void setup() {
  
  pinMode(buttonPin,INPUT);
  
  pinMode(micPin,INPUT);              //設定感測器D0为輸入

   Serial.begin(9600);
   // put your setup code here, to run once:
  
   display.begin(SSD1306_SWITCHCAPVCC,0x3D);
   display.clearDisplay();
   display.drawBitmap(0,0,start,64,32,WHITE);
   display.display();
}

void loop() {
  
  buttonState=digitalRead(buttonPin);
  if(buttonState==LOW)
  {
    val=digitalRead(micPin);              //將感測器的值讀取給给val
    if(val==HIGH)                         //當感測器测有信號時，LED閃爍
    {
          display.clearDisplay();
          display.drawBitmap(32,0,logo,64,32,WHITE);
          display.display();
    }
    else if(val==LOW)
    {
          display.clearDisplay();
          display.drawBitmap(32,0,P1,64,32,WHITE);
          display.display();
    }
    
  }
  else if(buttonState==HIGH)
  {
          display.clearDisplay();
          display.drawBitmap(32,0,start,64,32,WHITE);
          display.display();
  }
}

